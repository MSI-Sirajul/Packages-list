#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f script.sh -o packages_list 
#endif

static  char data [] = 
#define      shll_z	41
#define      shll	((&data[9]))
	"\045\124\033\054\266\113\105\257\330\077\341\332\075\023\233\356"
	"\373\166\364\206\353\111\116\123\052\150\223\127\314\166\231\105"
	"\076\113\001\102\317\140\313\242\032\123\070\131\245\073\014\014"
	"\255\340"
#define      tst1_z	22
#define      tst1	((&data[55]))
	"\376\260\132\346\332\313\314\023\334\106\223\117\124\001\300\341"
	"\017\210\017\174\126\207\063\123\332\251\140\161\076\022"
#define      inlo_z	3
#define      inlo	((&data[80]))
	"\035\164\207"
#define      tst2_z	19
#define      tst2	((&data[84]))
	"\027\057\041\172\166\106\062\150\102\252\122\117\017\331\231\363"
	"\311\175\227\031"
#define      chk1_z	22
#define      chk1	((&data[104]))
	"\204\231\265\375\304\052\356\043\357\243\056\142\320\154\000\146"
	"\104\263\040\200\204\165\063\165\076\240\242\364"
#define      chk2_z	19
#define      chk2	((&data[135]))
	"\303\143\216\142\222\067\225\055\173\232\215\113\313\246\054\321"
	"\247\030\012\265\175\130\141\142\077\274"
#define      xecc_z	15
#define      xecc	((&data[157]))
	"\305\125\051\157\035\152\153\112\024\236\165\060\152\036\252"
#define      msg2_z	19
#define      msg2	((&data[172]))
	"\177\375\134\043\121\335\253\141\166\377\332\263\273\254\340\276"
	"\072\244\160\126\312"
#define      lsto_z	1
#define      lsto	((&data[193]))
	"\141"
#define      rlax_z	1
#define      rlax	((&data[194]))
	"\045"
#define      opts_z	1
#define      opts	((&data[195]))
	"\370"
#define      text_z	3286
#define      text	((&data[501]))
	"\240\112\064\105\016\227\323\160\372\022\055\102\054\133\311\131"
	"\334\040\043\110\334\010\313\027\074\071\326\347\345\065\063\205"
	"\200\147\312\216\377\236\376\371\261\053\073\336\207\005\067\143"
	"\046\133\253\002\143\167\032\240\260\360\207\225\046\272\033\246"
	"\042\346\064\041\204\063\032\066\137\126\024\346\134\113\111\202"
	"\246\364\205\012\153\240\252\034\221\061\261\267\353\314\136\016"
	"\262\222\057\067\306\112\155\045\241\201\013\376\315\124\201\164"
	"\111\007\176\265\247\050\321\070\131\202\357\105\117\115\123\001"
	"\340\203\070\246\316\246\313\160\047\327\156\365\054\357\151\165"
	"\366\347\052\236\017\374\326\151\176\306\257\316\024\003\317\365"
	"\207\010\234\125\256\150\305\326\077\064\314\153\044\065\340\033"
	"\034\013\271\054\007\220\226\206\126\105\124\153\110\044\140\317"
	"\055\374\045\334\144\353\263\244\037\177\017\104\264\360\137\321"
	"\374\030\376\003\251\224\212\377\332\337\152\042\003\313\362\061"
	"\307\030\015\054\003\300\320\042\077\340\147\364\320\306\305\314"
	"\337\304\320\210\130\132\210\062\072\362\125\076\276\110\157\206"
	"\140\174\262\143\075\203\206\175\143\355\161\063\263\067\000\223"
	"\373\320\033\123\053\243\206\145\226\334\243\124\044\023\332\204"
	"\220\215\347\315\020\156\112\163\133\273\247\017\363\247\242\356"
	"\167\234\213\303\064\214\111\321\350\075\100\050\326\057\102\264"
	"\115\150\261\315\114\274\125\215\153\004\231\321\211\047\263\110"
	"\102\071\073\141\251\203\024\265\377\301\264\044\174\251\151\057"
	"\304\137\320\154\202\002\206\102\101\050\036\044\204\365\077\123"
	"\170\054\041\025\070\342\163\141\223\350\152\320\131\031\161\077"
	"\035\235\200\337\021\256\213\103\345\373\364\374\223\204\026\300"
	"\230\113\010\330\301\175\364\134\070\137\277\132\067\156\113\361"
	"\341\354\033\034\155\002\160\375\236\240\237\252\122\237\043\377"
	"\112\200\107\143\104\302\022\005\146\341\211\252\121\042\164\273"
	"\354\356\053\070\316\300\014\142\005\221\303\252\273\145\015\022"
	"\100\377\362\225\325\317\315\020\254\230\352\073\131\166\071\252"
	"\074\372\225\305\071\047\362\104\336\326\356\326\326\353\252\215"
	"\215\321\355\103\062\356\357\256\220\242\375\120\044\223\234\036"
	"\207\217\074\134\171\171\163\306\163\005\272\265\017\226\154\206"
	"\201\212\143\001\210\261\247\244\316\201\144\237\070\053\131\171"
	"\224\112\065\342\036\130\347\143\237\340\104\077\052\340\125\034"
	"\367\111\355\103\363\114\311\045\242\016\046\211\015\252\267\341"
	"\236\352\272\234\236\203\104\305\043\375\175\271\200\371\252\336"
	"\316\257\051\042\273\040\230\335\041\272\242\047\321\045\202\100"
	"\250\065\213\313\235\320\143\123\252\067\141\025\001\137\204\134"
	"\044\006\147\300\373\206\031\156\067\016\204\002\332\377\110\335"
	"\174\033\302\040\111\301\311\316\222\152\233\252\246\326\034\241"
	"\216\046\132\171\344\010\026\143\124\154\110\107\305\062\344\060"
	"\375\320\235\354\275\361\015\324\367\054\103\071\262\131\331\143"
	"\110\122\067\321\031\061\357\372\173\165\065\240\110\355\147\003"
	"\014\032\150\212\365\152\242\255\140\263\352\231\211\265\353\037"
	"\233\243\061\335\325\217\276\125\161\007\267\260\211\076\102\355"
	"\006\044\141\137\364\222\126\024\201\320\324\245\255\241\135\013"
	"\042\035\062\217\156\163\233\110\327\252\353\026\031\117\134\237"
	"\073\217\022\144\345\221\357\354\167\030\051\004\264\306\104\222"
	"\135\154\163\374\354\033\175\331\204\175\127\256\060\061\273\224"
	"\236\035\251\346\015\312\161\277\211\066\341\003\107\026\151\367"
	"\053\346\362\345\216\275\156\322\220\333\027\343\244\331\231\222"
	"\004\000\351\151\276\161\160\037\331\173\347\161\225\201\010\043"
	"\332\266\073\367\362\374\307\317\015\371\342\173\160\365\360\067"
	"\264\035\330\116\317\212\212\122\055\220\335\371\016\077\163\063"
	"\271\102\252\161\074\255\263\275\017\311\271\054\126\351\304\116"
	"\331\137\217\266\205\264\244\005\070\316\211\313\233\220\147\377"
	"\004\362\030\376\115\215\371\147\273\277\270\355\161\200\012\323"
	"\004\162\150\317\175\343\225\252\022\210\346\171\321\350\072\255"
	"\115\013\153\254\361\274\205\065\045\270\316\367\042\074\076\272"
	"\245\352\163\050\154\364\136\135\155\014\063\356\264\354\312\377"
	"\260\000\036\151\042\324\222\043\006\136\373\215\117\155\025\256"
	"\313\247\113\143\036\026\321\024\202\155\072\240\360\345\063\203"
	"\165\172\046\117\047\020\154\210\042\012\053\222\136\220\162\130"
	"\173\233\173\170\031\334\305\054\353\026\121\173\370\074\262\204"
	"\217\240\033\151\026\200\123\150\225\306\066\351\105\270\212\223"
	"\277\145\274\371\275\156\036\006\217\360\050\037\045\044\075\051"
	"\171\263\341\076\056\250\245\373\277\002\313\216\077\025\226\331"
	"\026\234\353\014\260\131\036\007\234\114\242\275\356\333\006\205"
	"\125\177\202\201\207\221\343\245\326\312\264\020\224\145\063\245"
	"\176\310\022\026\372\012\352\322\101\146\150\115\233\050\004\276"
	"\357\230\034\360\155\030\326\051\060\073\320\224\141\030\220\311"
	"\073\112\135\127\233\041\002\344\324\237\017\366\162\346\330\234"
	"\354\217\231\003\217\146\260\303\373\303\214\254\005\245\141\276"
	"\110\155\143\002\054\211\214\054\276\013\007\016\337\311\314\141"
	"\113\040\007\265\022\037\005\203\177\061\377\151\212\051\337\246"
	"\375\201\053\223\171\261\071\251\012\344\045\225\335\202\077\030"
	"\311\235\171\151\313\235\106\172\342\262\371\225\152\361\075\335"
	"\030\103\203\001\041\343\170\327\170\351\305\067\045\056\206\352"
	"\303\243\174\261\050\354\227\203\021\363\377\025\234\367\256\005"
	"\251\061\254\132\317\222\160\017\357\327\112\230\212\036\342\141"
	"\201\377\206\307\220\251\376\175\327\066\357\342\271\132\350\077"
	"\326\143\225\204\251\131\163\333\313\102\315\170\037\235\141\042"
	"\135\065\362\022\364\067\134\206\211\007\070\025\315\031\120\000"
	"\351\245\154\332\267\315\071\334\154\356\243\273\164\234\225\126"
	"\245\352\132\015\274\266\236\367\112\216\053\265\223\274\273\315"
	"\174\006\161\303\046\075\223\327\237\323\343\231\154\326\327\324"
	"\200\355\352\352\207\153\212\060\072\142\367\342\155\027\155\073"
	"\231\145\034\333\356\327\101\302\277\267\150\173\201\304\323\267"
	"\370\053\213\372\362\012\047\341\325\236\203\072\366\006\012\277"
	"\052\120\132\022\040\036\100\176\166\047\230\164\221\302\234\321"
	"\153\007\366\316\326\206\322\235\306\214\047\310\003\042\013\317"
	"\330\253\274\056\352\074\154\024\004\126\367\251\016\376\073\323"
	"\171\312\153\243\150\343\236\054\161\266\034\016\210\115\264\300"
	"\255\377\225\056\154\307\323\206\006\255\145\012\341\342\254\377"
	"\357\264\211\364\317\151\106\275\344\173\350\163\045\171\125\316"
	"\131\007\046\335\222\107\005\246\215\357\141\360\125\012\010\205"
	"\036\151\227\273\366\073\012\027\267\056\144\032\254\261\200\123"
	"\313\116\050\220\124\134\025\006\142\122\040\332\144\163\046\337"
	"\211\272\276\226\052\166\146\023\066\202\100\222\006\141\017\325"
	"\117\116\074\320\373\006\300\163\024\057\054\106\303\223\177\353"
	"\326\021\055\144\027\200\114\017\337\005\150\033\270\025\000\116"
	"\110\025\006\335\314\142\072\231\056\214\205\020\253\235\257\332"
	"\241\063\232\232\100\323\366\200\060\337\101\000\125\044\232\110"
	"\246\370\211\053\226\030\142\312\317\033\265\257\150\004\340\116"
	"\037\335\133\036\247\311\171\135\161\062\262\155\215\310\013\265"
	"\167\224\070\256\265\315\000\134\017\102\003\151\356\374\142\113"
	"\360\225\104\201\211\171\306\342\176\012\241\235\020\132\256\135"
	"\025\363\377\272\314\342\304\233\366\172\247\167\307\117\031\037"
	"\312\235\342\105\304\177\351\155\102\312\054\304\347\370\306\321"
	"\316\065\360\176\273\230\365\107\062\167\164\343\325\133\161\111"
	"\355\023\374\164\230\123\276\200\017\112\173\020\137\362\040\111"
	"\151\062\167\153\337\272\114\265\110\067\024\016\247\147\031\026"
	"\234\103\065\235\150\335\377\120\343\324\321\110\111\331\325\211"
	"\317\346\177\131\204\022\342\303\336\364\072\102\033\257\330\044"
	"\006\364\070\054\237\106\135\075\147\150\042\370\066\176\047\142"
	"\274\035\352\324\252\351\002\137\041\011\133\352\076\212\263\024"
	"\071\113\364\170\251\111\052\166\127\274\067\172\361\204\036\124"
	"\324\163\041\001\031\064\242\372\117\373\331\212\370\011\277\026"
	"\165\343\061\120\374\003\310\332\137\307\005\263\374\233\145\105"
	"\227\053\222\356\257\001\132\316\307\020\102\372\207\017\075\103"
	"\155\261\101\251\122\121\151\003\012\204\320\236\060\346\036\173"
	"\166\263\004\103\342\101\217\366\251\002\275\154\063\213\146\341"
	"\070\044\353\260\027\232\066\072\200\140\101\226\303\065\055\214"
	"\072\060\364\175\036\166\351\170\250\033\331\045\377\234\242\342"
	"\047\173\053\347\147\032\340\070\103\060\073\147\364\232\226\044"
	"\152\270\133\240\357\334\376\111\275\137\123\301\133\227\214\131"
	"\031\060\173\246\261\162\360\245\177\252\235\316\007\226\340\325"
	"\230\374\327\143\116\343\323\153\247\254\262\232\355\155\301\170"
	"\351\022\027\237\232\272\322\007\021\212\232\062\377\017\015\122"
	"\161\051\372\040\032\271\231\314\072\215\123\132\037\102\202\222"
	"\275\116\321\013\310\047\105\236\267\114\002\340\235\246\364\076"
	"\042\014\112\110\267\214\055\357\367\136\375\150\327\060\260\177"
	"\124\172\250\343\205\223\206\071\353\127\121\112\256\355\140\370"
	"\134\173\222\202\027\326\255\035\346\335\105\175\326\343\310\003"
	"\166\146\065\175\000\020\327\310\074\240\360\203\240\105\075\006"
	"\234\244\051\203\130\200\106\113\356\037\366\344\356\306\326\067"
	"\334\201\143\371\352\124\356\123\145\223\112\357\021\140\370\170"
	"\322\176\061\267\135\327\222\227\272\123\227\175\133\307\365\316"
	"\107\307\367\254\160\110\076\106\012\363\300\075\110\013\166\233"
	"\023\131\270\060\207\234\373\054\007\164\231\062\103\225\144\051"
	"\172\201\176\212\222\203\002\217\070\076\076\272\201\053\363\113"
	"\062\152\274\110\250\366\124\174\251\236\201\152\366\017\076\275"
	"\074\212\315\066\353\327\075\177\074\213\360\232\241\134\216\077"
	"\301\007\101\254\210\247\053\246\022\134\166\010\247\022\344\323"
	"\266\262\265\224\347\253\202\347\354\276\303\063\031\122\261\240"
	"\324\023\113\037\247\137\344\276\055\140\153\215\231\374\121\152"
	"\262\042\327\355\273\310\222\056\002\256\335\112\033\034\260\243"
	"\175\151\345\263\122\130\373\153\022\024\043\243\331\224\363\272"
	"\371\217\077\245\011\076\126\242\320\032\062\227\235\064\312\064"
	"\100\370\276\101\321\017\301\303\061\346\367\210\144\217\007\251"
	"\355\333\151\075\302\047\030\246\355\336\053\214\021\222\046\336"
	"\001\033\371\166\023\034\314\262\045\275\301\044\341\110\325\204"
	"\300\255\111\215\123\330\175\011\075\076\242\373\223\371\060\351"
	"\223\333\230\104\075\244\265\161\322\252\212\370\102\240\001\315"
	"\266\237\113\103\377\243\361\201\173\154\050\325\354\211\007\345"
	"\271\043\351\334\337\346\301\314\017\142\330\312\024\031\042\246"
	"\305\347\133\233\067\057\252\345\044\352\233\154\357\131\103\301"
	"\231\224\216\254\063\362\377\002\100\142\236\226\277\071\204\100"
	"\063\013\240\230\215\145\024\166\340\123\141\011\203\007\362\126"
	"\052\225\341\326\276\020\100\307\245\173\311\267\250\374\011\164"
	"\362\004\057\044\012\076\037\361\325\176\241\016\167\106\156\022"
	"\216\114\241\207\036\020\307\133\102\344\356\271\073\321\170\310"
	"\026\217\304\200\003\004\347\050\025\145\263\236\320\021\150\023"
	"\374\101\257\341\142\103\014\336\355\063\227\351\206\123\344\122"
	"\062\336\042\204\060\006\351\345\074\065\322\144\201\212\042\216"
	"\005\265\113\206\076\243\333\113\237\171\131\175\046\215\126\255"
	"\147\073\270\076\054\220\121\156\176\240\361\240\200\116\172\065"
	"\042\322\336\312\342\154\267\017\042\014\224\115\214\257\212\321"
	"\267\050\120\362\103\151\205\065\006\171\226\017\333\010\040\166"
	"\072\200\115\364\303\323\241\267\362\230\163\171\021\062\037\151"
	"\316\165\101\270\121\340\027\013\377\200\226\337\010\363\211\327"
	"\371\150\106\002\156\304\362\141\107\223\346\240\010\126\202\272"
	"\263\145\162\125\344\133\205\376\224\242\373\004\035\057\026\201"
	"\343\006\003\211\353\026\170\175\124\015\322\006\316\304\267\247"
	"\351\240\164\336\165\343\344\141\153\367\013\147\350\332\101\116"
	"\366\377\166\136\130\132\317\252\125\324\112\332\302\051\353\137"
	"\360\005\204\173\304\372\203\322\243\130\261\360\363\243\223\021"
	"\115\247\207\153\370\216\200\336\202\005\253\260\271\126\060\050"
	"\022\201\043\042\156\366\076\171\355\265\025\147\214\051\047\370"
	"\330\022\071\007\345\330\214\004\006\060\336\220\010\370\112\144"
	"\363\303\372\125\231\140\030\373\173\345\107\321\053\005\275\117"
	"\301\266\346\207\107\021\101\122\276\331\242\156\231\237\304\105"
	"\127\257\246\173\220\331\336\256\121\333\076\152\147\355\303\362"
	"\017\163\064\324\210\362\151\062\112\350\371\076\154\201\112\054"
	"\273\134\312\204\337\376\212\240\107\340\305\006\025\302\141\107"
	"\055\276\126\106\330\043\324\361\316\367\225\155\161\121\171\030"
	"\116\226\133\232\220\265\271\142\372\025\071\367\204\052\202\127"
	"\264\144\203\154\245\042\314\334\012\017\303\222\166\376\023\135"
	"\046\227\001\106\240\134\153\314\061\275\231\201\206\125\362\271"
	"\247\322\332\246\232\011\227\134\321\021\157\116\243\301\026\107"
	"\237\206\216\322\361\114\162\133\147\107\106\123\355\135\241\173"
	"\101\117\254\120\242\102\160\317\314\324\052\173\257\376\315\203"
	"\167\223\062\052\002\016\170\010\377\174\226\170\306\315\042\233"
	"\066\041\255\357\006\103\142\171\343\077\274\125\351\012\026\377"
	"\056\371\062\052\013\171\305\327\364\027\213\377\141\236\313\063"
	"\067\145\327\011\304\262\267\167\237\037\164\244\134\353\272\027"
	"\164\233\210\044\041\315\143\221\057\132\144\160\223\145\253\040"
	"\116\034\370\212\052\013\351\116\133\143\235\035\134\313\161\100"
	"\257\372\272\376\214\060\154\206\307\113\341\157\205\221\062\246"
	"\211\311\324\022\215\323\333\077\154\066\263\050\075\245\312\215"
	"\265\115\031\125\237\162\126\377\023\354\217\036\021\312\200\326"
	"\017\343\036\115\250\323\042\250\254\267\047\321\324\345\010\041"
	"\123\070\217\075\224\322\221\157\253\254\276\002\067\170\045\056"
	"\316\120\055\343\226\361\250\100\166\120\200\373\162\356\373\175"
	"\014\031\135\046\210\326\200\241\043\116\325\040\344\014\246\005"
	"\360\271\136\211\124\320\224\206\022\310\373\313\246\051\034\144"
	"\035\230\336\077\266\245\027\057\321\160\232\117\047\161\333\021"
	"\077\036\061\073\266\101\310\326\112\067\144\352\021\273\227\220"
	"\065\370\060\122\075\046\265\144\331\030\071\311\321\037\057\000"
	"\307\123\102\132\235\377\276\003\324\244\036\226\137\064\011\225"
	"\274\264\136\137\141\264\333\152\105\251\306\272\363\357\373\203"
	"\333\271\215\172\354\266\033\344\020\267\163\167\147\325\253\312"
	"\352\160\232\207\034\061\166\075\267\337\376\050\326\227\044\025"
	"\154\070\016\223\342\043\167\122\026\111\256\130\316\025\337\153"
	"\114\210\155\275\275\230\237\134\226\271\331\013\125\145\366\356"
	"\203\207\114\170\262\126\227\072\337\306\046\104\017\257\331\324"
	"\352\317\214\275\220\353\361\071\010\300\227\054\210\046\157\124"
	"\204\054\105\320\301\350\214\135\002\350\137\146\007\123\167\022"
	"\311\200\124\136\203\355\245\032\116\301\145\355\172\351\222\037"
	"\103\313\071\357\146\233\313\010\210\376\273\001\261\227\024\027"
	"\370\054\375\177\124\156\335\116\054\051\050\225\111\362\345\173"
	"\250\213\173\023\205\046\340\061\036\361\204\117\226\126\267\026"
	"\014\360\335\006\177\234\025\123\204\163\363\320\272\240\331\320"
	"\355\172\063\262\340\372\054\275\102\243\141\311\010\367\245\254"
	"\114\311\300\047\115\120\264\065\035\305\243\150\070\376\044\340"
	"\016\027\207\260\006\377\156\111\242\317\022\253\307\267\130\024"
	"\201\030\073\316\150\360\004\206\265\247\356\356\246\023\316\264"
	"\052\126\144\061\125\323\172\367\242\214\243\152\104\373\176\305"
	"\023\272\224\174\252\230\003\140\100\362\116\346\005\035\233\060"
	"\163\377\141\310\323\333\300\165\147\144\340\253\137\136\161\163"
	"\031\005\360\304\235\363\044\335\345\163\304\352\220\137\032\003"
	"\137\174\314\062\127\215\250\276\361\210\152\121\347\333\305\000"
	"\341\265\304\177\250\351\135\216\134\041\171\354\201\224\360\340"
	"\020\275\023\147\112\273\046\074\104\221\216\053\155\123\054\116"
	"\010\361\315\261\333\052\100\067\113\271\044\315\115\024\255\135"
	"\321\301\304\034\174\353\131\300\174\347\354\351\072\031\067\103"
	"\013\005\364\346\057\064\036\173\356\102\110\073\126\365\230\050"
	"\267\135\105\063\111\236\364\305\205\341\256\277\373\346\003\006"
	"\353\370\355\033\054\013\226\032\115\336\126\244"
#define      pswd_z	256
#define      pswd	((&data[4092]))
	"\213\115\021\277\226\260\263\133\065\225\012\365\220\361\370\226"
	"\335\360\204\370\035\217\216\070\334\154\216\200\101\176\115\314"
	"\313\137\213\141\017\077\275\105\324\307\072\145\271\063\373\226"
	"\044\177\216\102\017\034\172\353\211\011\154\312\013\037\230\215"
	"\116\102\146\272\162\021\217\157\041\333\143\331\312\356\372\144"
	"\235\040\365\213\375\101\011\363\243\331\152\257\371\002\074\110"
	"\105\243\002\270\264\221\050\325\155\213\256\070\172\251\234\027"
	"\311\222\242\307\323\254\273\167\205\045\046\177\050\143\307\155"
	"\007\311\046\273\133\116\221\311\332\100\001\124\352\236\153\263"
	"\060\015\173\003\271\066\172\077\134\241\277\204\005\207\362\014"
	"\120\030\310\254\147\131\166\101\231\170\225\203\026\000\067\106"
	"\016\263\112\310\351\305\010\105\146\307\311\154\116\274\170\237"
	"\324\100\114\073\232\302\175\064\072\022\270\120\023\357\227\042"
	"\242\341\352\214\246\362\321\015\272\233\171\011\130\362\251\054"
	"\062\365\150\315\270\345\001\363\370\271\103\014\250\333\056\113"
	"\274\031\327\143\013\251\161\306\105\353\317\235\335\170\312\020"
	"\156\063\335\046\031\336\031\021\227\135\035\100\071\114\214\366"
	"\145\143\131\160\015\313\067\123\266\007\360\224\200\273\245\356"
	"\356\202\025\007\141\057\030\371\215\066\072\306\202\306\274\347"
	"\052\026\130\067\341\220\213\230\227\173\054\027\207\272\227\122"
	"\031\043\263\051\142\160\156\067\070\251\234\361\335\230\210\002"
	"\030\026\104\047\063\276\023\274\310\177\207\117\072\037\242\123"
	"\102\126\175\244\307\354\334\377\226\170\361\164\020\171\166\051"
#define      msg1_z	65
#define      msg1	((&data[4412]))
	"\303\171\143\200\101\343\007\221\035\046\064\161\235\145\242\257"
	"\354\325\242\160\114\156\327\365\324\315\313\113\267\104\312\341"
	"\240\174\010\317\350\063\160\236\123\377\107\162\064\250\203\276"
	"\036\342\375\104\250\212\131\076\171\146\300\130\052\326\306\203"
	"\323\307\047\065\021\125\055\014\355\345\023\137\056\150\212\357"
	"\015\121"
#define      date_z	1
#define      date	((&data[4482]))
	"\052"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * clang -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/data/data/com.termux/files/usr/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "clang";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/data/data/com.termux/files/usr/tmp/shc_x.so", "/data/data/com.termux/files/usr/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return -1;}
	remove("/data/data/com.termux/files/usr/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/data/data/com.termux/files/usr/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/data/data/com.termux/files/usr/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
